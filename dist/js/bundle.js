!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var o={holderId:"root-holder",localeStorageKey:"toToStorage"};var n,a=function(){function t(t){this.id=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.text=t||"Новый проект",this.isDone=!1}return t.prototype.toggleStatus=function(){this.isDone=!this.isDone},t.prototype.changeText=function(t){this.text=t},t.prototype.update=function(t){return this.id=t.id,this.text=t.text,this.isDone=t.isDone,this},t}();!function(t){t.setItem=function(t,e){localStorage.setItem(t,JSON.stringify(e))},t.getItem=function(t){return JSON.parse(localStorage.getItem(t))},t.removeItem=function(t){this.contains(t)&&localStorage.removeItem(t)},t.contains=function(t){return!!localStorage.getItem(t)},t.clear=function(){localStorage.clear()}}(n||(n={}));var c=function(){function t(){var t=this;this.storage=[];var e=n.getItem(o.localeStorageKey);e&&e.length&&e.forEach(function(e){t.storage.push((new a).update(e))})}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.search=function(t){return t.length?this.storage.filter(function(e){return e.text.toLowerCase().indexOf(t.toLowerCase())>=0}):this.storage},t.prototype.get=function(t){return this.storage.find(function(e){return e.id===t})},t.prototype.add=function(t){var e=new a(t);return this.storage.unshift(e),e.id},t.prototype.replace=function(t){this.storage.map(function(e){return e.id===t.id?t:e})},t.prototype.remove=function(t){this.storage=this.storage.filter(function(e){return e.id!==t})},t.prototype.getStorage=function(){return this.storage},t}(),i=function(){function t(t){this.searchStr="",this.renderUpdater=t,this.dataStorage=c.getInstance(),window.addEventListener("unload",this.unloadHandler.bind(this))}return t.prototype.unloadHandler=function(){n.setItem(o.localeStorageKey,this.dataStorage.getStorage())},t.prototype.searchByProjects=function(){var t=this;return function(){var e=this.value,r=t.dataStorage.search(e);t.renderUpdater(r),t.searchStr=e}},t.prototype.clickProject=function(t){var e=this;return function(){var r=e.dataStorage.get(t.id);r.toggleStatus(),e.dataStorage.replace(r),e.renderUpdater()}},t.prototype.editProject=function(t){var e=this;return function(r){var o=r.target.textContent,n=e.dataStorage.get(t.id);n.changeText(o),e.dataStorage.replace(n)}},t.prototype.createProject=function(){var t=this;return function(){t.dataStorage.add(),t.renderUpdater()}},t.prototype.removeProject=function(t){var e=this;return function(){e.dataStorage.remove(t.id);var r=e.dataStorage.getStorage();e.searchStr&&(r=e.dataStorage.search(e.searchStr)),e.renderUpdater(r)}},t}();(new(function(){function t(){this.controller=new i(this.updateProjectList.bind(this)),this.projectsList=c.getInstance().getStorage(),this.rootEl=document.getElementById(o.holderId)}return t.prototype.render=function(){var t=document.createDocumentFragment();t.append(this.createInputNode(),this.createProjectsNode(),this.createNewProjectNode()),this.rootEl.prepend(document.createElement("div")),this.rootEl.children[0].appendChild(t)},t.prototype.updateProjectList=function(t){void 0===t&&(t=this.projectsList),this.projectsList=t,document.querySelector(".project-list__project-wrapper").replaceWith(this.createProjectsNode())},t.prototype.createInputNode=function(){var t=document.createElement("input");return t.className="project-list__search-filed",t.placeholder="Поиск по проектам...",t.autofocus=!0,t.oninput=this.controller.searchByProjects(),t},t.prototype.createProjectsNode=function(){var t=this,e=document.createElement("div");return e.className="project-list__project-wrapper",this.projectsList.forEach(function(r){e.appendChild(t.createProjectNode(r))}),e},t.prototype.createProjectNode=function(t){var e=document.createElement("div");e.className="project-list__project";var r=document.createElement("input");r.type="checkbox",r.className="project-list__project-checkbox",r.checked=t.isDone,r.onclick=this.controller.clickProject(t);var o=document.createElement("span"),n=t.isDone?" project-list__project-value_done":"";o.className="project-list__project-value"+n,o.innerText=t.text,o.contentEditable="true",o.oninput=this.controller.editProject(t);var a=document.createElement("span");return a.className="project-list__remove-project",a.innerText="X",a.title="Удалить проект",a.onclick=this.controller.removeProject(t),e.append(r,o,a),e},t.prototype.createNewProjectNode=function(){var t=document.createElement("div");t.className="project-list__add-project";var e=document.createElement("span");return e.className="project-list__add-project-button",e.innerText="Добавить новый проект",e.onclick=this.controller.createProject(),t.appendChild(e),t},t}())).render()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbmZpZy9jb25maWcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Byb2plY3RNb2RlbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy9Mb2NhbFN0b3JhZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hlbHBlcnMvY3RyYXRlVWlkLnRzIiwid2VicGFjazovLy8uL3NyYy9EYXRhU3RvcmFnZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29udHJvbGxlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1JlbmRlcmVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY29uZmlnIiwiaG9sZGVySWQiLCJsb2NhbGVTdG9yYWdlS2V5IiwiTG9jYWxlU3RvcmFnZSIsIlByb2plY3RNb2RlbF9Qcm9qZWN0TW9kZWwiLCJQcm9qZWN0TW9kZWwiLCJ0ZXh0IiwidGhpcyIsImlkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiaXNEb25lIiwidG9nZ2xlU3RhdHVzIiwiY2hhbmdlVGV4dCIsInVwZGF0ZSIsImRhdGEiLCJzZXRJdGVtIiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldEl0ZW0iLCJwYXJzZSIsInJlbW92ZUl0ZW0iLCJjb250YWlucyIsImNsZWFyIiwiRGF0YVN0b3JhZ2VfRGF0YVN0b3JhZ2UiLCJEYXRhU3RvcmFnZSIsIl90aGlzIiwic3RvcmFnZSIsInNhdmVkRGF0YSIsImxlbmd0aCIsImZvckVhY2giLCJpdGVtIiwicHVzaCIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJzZWFyY2giLCJzdHIiLCJmaWx0ZXIiLCJwbSIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsImZpbmQiLCJhZGQiLCJ1bnNoaWZ0IiwicmVwbGFjZSIsIm1hcCIsInByb2plY3RNb2RlbCIsInJlbW92ZSIsImdldFN0b3JhZ2UiLCJDb250cm9sbGVyX0NvbnRyb2xsZXIiLCJDb250cm9sbGVyIiwidXBkYXRlciIsInNlYXJjaFN0ciIsInJlbmRlclVwZGF0ZXIiLCJkYXRhU3RvcmFnZSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1bmxvYWRIYW5kbGVyIiwic2VhcmNoQnlQcm9qZWN0cyIsInRoYXQiLCJ1cGRhdGVkRGF0YVN0b3JhZ2UiLCJjbGlja1Byb2plY3QiLCJlZGl0UHJvamVjdCIsImUiLCJ0YXJnZXQiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZVByb2plY3QiLCJyZW1vdmVQcm9qZWN0IiwicHJvamVjdExpc3QiLCJSZW5kZXJlciIsImNvbnRyb2xsZXIiLCJ1cGRhdGVQcm9qZWN0TGlzdCIsInByb2plY3RzTGlzdCIsInJvb3RFbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW5kZXIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJhcHBlbmQiLCJjcmVhdGVJbnB1dE5vZGUiLCJjcmVhdGVQcm9qZWN0c05vZGUiLCJjcmVhdGVOZXdQcm9qZWN0Tm9kZSIsInByZXBlbmQiLCJjcmVhdGVFbGVtZW50IiwiY2hpbGRyZW4iLCJhcHBlbmRDaGlsZCIsImRhdGFTb3VyY2UiLCJxdWVyeVNlbGVjdG9yIiwicmVwbGFjZVdpdGgiLCJpbnB1dCIsImNsYXNzTmFtZSIsInBsYWNlaG9sZGVyIiwiYXV0b2ZvY3VzIiwib25pbnB1dCIsIndyYXBwZXJOb2RlIiwiY3JlYXRlUHJvamVjdE5vZGUiLCJwcm9qZWN0V3JhcHBlck5vZGUiLCJwcm9qZWN0Q2hlY2tib3hOb2RlIiwidHlwZSIsImNoZWNrZWQiLCJvbmNsaWNrIiwicHJvamVjdFZhbHVlTm9kZSIsInByb2plY3RWYWx1ZUNzc01vZGlmaWVyIiwiaW5uZXJUZXh0IiwiY29udGVudEVkaXRhYmxlIiwicHJvamVjdFJlbW92ZU5vZGUiLCJ0aXRsZSIsIm5ld1Byb2plY3ROb2RlIiwibmV3UHJvamVjdEJ1dHRvbk5vZGUiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVBQUFVLEVBQUFlLEVBQUFFLEVBQUEsU0FBQUEsR0FBZ0gsT0FBQU4sRUFBQU0sSUFBcUJDLEtBQUEsS0FBQUQsSUFDckksT0FBQUYsR0FJQXpCLEVBQUE2QixFQUFBLFNBQUExQixHQUNBLElBQUFTLEVBQUFULEtBQUFxQixXQUNBLFdBQTJCLE9BQUFyQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBaUIsRUFBQUMsR0FBc0QsT0FBQWpCLE9BQUFrQixVQUFBQyxlQUFBMUIsS0FBQXVCLEVBQUFDLElBR3REL0IsRUFBQWtDLEVBQUEsR0FJQWxDLElBQUFtQyxFQUFBLHlDQ2xGTyxJQUFNQyxFQUFTLENBQ2xCQyxTQUFVLGNBQ1ZDLGlCQUFrQixlQ0F0QixJQ0ZpQkMsRURFakJDLEVBQUEsV0FLSSxTQUFBQyxFQUFZQyxHQUNSQyxLQUFLQyxHRVBMQyxLQUFLQyxTQUFTQyxTQUFTLElBQUlDLFVBQVUsRUFBRyxJQUFNSCxLQUFLQyxTQUFTQyxTQUFTLElBQUlDLFVBQVUsRUFBRyxJRlF0RkwsS0FBS0QsS0FBT0EsR0FBUSxlQUNwQkMsS0FBS00sUUFBUyxFQWtCdEIsT0FmV1IsRUFBQVQsVUFBQWtCLGFBQVAsV0FDSVAsS0FBS00sUUFBVU4sS0FBS00sUUFHakJSLEVBQUFULFVBQUFtQixXQUFQLFNBQWtCVCxHQUNkQyxLQUFLRCxLQUFPQSxHQUdURCxFQUFBVCxVQUFBb0IsT0FBUCxTQUFjQyxHQUtWLE9BSkFWLEtBQUtDLEdBQUtTLEVBQUtULEdBQ2ZELEtBQUtELEtBQU9XLEVBQUtYLEtBQ2pCQyxLQUFLTSxPQUFTSSxFQUFLSixPQUVaTixNQUVmRixFQTFCQSxJQ0ZBLFNBQWlCRixHQUNHQSxFQUFBZSxRQUFoQixTQUF3QjNCLEVBQWFOLEdBQ3ZDa0MsYUFBYUQsUUFBUTNCLEVBQUs2QixLQUFLQyxVQUFVcEMsS0FHMUJrQixFQUFBbUIsUUFBaEIsU0FBaUMvQixHQUNoQyxPQUFPNkIsS0FBS0csTUFBTUosYUFBYUcsUUFBUS9CLEtBR3hCWSxFQUFBcUIsV0FBaEIsU0FBMkJqQyxHQUN0QmdCLEtBQUtrQixTQUFTbEMsSUFDakI0QixhQUFhSyxXQUFXakMsSUFJVlksRUFBQXNCLFNBQWhCLFNBQXlCbEMsR0FDeEIsUUFBUzRCLGFBQWFHLFFBQVEvQixJQUdmWSxFQUFBdUIsTUFBaEIsV0FDQ1AsYUFBYU8sU0FwQmYsQ0FBaUJ2QixNQUFhLEtFSTlCLElBQUF3QixFQUFBLFdBWUMsU0FBQUMsSUFBQSxJQUFBQyxFQUFBdEIsS0FYV0EsS0FBQXVCLFFBQStCLEdBWW5DLElBQU1DLEVBQVk1QixFQUFjbUIsUUFBaUN0QixFQUFPRSxrQkFDbEU2QixHQUFlQSxFQUFVQyxRQUMzQkQsRUFBVUUsUUFBUSxTQUFBQyxHQUNkTCxFQUFLQyxRQUFRSyxNQUFLLElBQUkvQixHQUFlWSxPQUFPa0IsTUFzQzVELE9BbERRTixFQUFBUSxZQUFQLFdBS0MsT0FKS1IsRUFBWVMsV0FDaEJULEVBQVlTLFNBQVcsSUFBSVQsR0FHckJBLEVBQVlTLFVBWVZULEVBQUFoQyxVQUFBMEMsT0FBUCxTQUFjQyxHQUNWLE9BQUtBLEVBQUlQLE9BR0Z6QixLQUFLdUIsUUFBUVUsT0FBTyxTQUFBQyxHQUFNLE9BQUFBLEVBQUduQyxLQUFLb0MsY0FBY0MsUUFBUUosRUFBSUcsZ0JBQWtCLElBRjFFbkMsS0FBS3VCLFNBS2JGLEVBQUFoQyxVQUFBZixJQUFQLFNBQVcyQixHQUNQLE9BQU9ELEtBQUt1QixRQUFRYyxLQUFLLFNBQUFILEdBQU0sT0FBQUEsRUFBR2pDLEtBQU9BLEtBR3RDb0IsRUFBQWhDLFVBQUFpRCxJQUFQLFNBQVd2QyxHQUNQLElBQU1tQyxFQUFLLElBQUlyQyxFQUFhRSxHQUU1QixPQURBQyxLQUFLdUIsUUFBUWdCLFFBQVFMLEdBQ2RBLEVBQUdqQyxJQUdQb0IsRUFBQWhDLFVBQUFtRCxRQUFQLFNBQWVOLEdBQ1hsQyxLQUFLdUIsUUFBUWtCLElBQUksU0FBQUMsR0FDYixPQUFJQSxFQUFhekMsS0FBT2lDLEVBQUdqQyxHQUNoQmlDLEVBRUpRLEtBSVJyQixFQUFBaEMsVUFBQXNELE9BQVAsU0FBYzFDLEdBQ1ZELEtBQUt1QixRQUFVdkIsS0FBS3VCLFFBQVFVLE9BQU8sU0FBQUMsR0FBTSxPQUFBQSxFQUFHakMsS0FBT0EsS0FHaERvQixFQUFBaEMsVUFBQXVELFdBQVAsV0FDSSxPQUFPNUMsS0FBS3VCLFNBRXBCRixFQXREQSxHQ0NBd0IsRUFBQSxXQUtJLFNBQUFDLEVBQVlDLEdBRkovQyxLQUFBZ0QsVUFBb0IsR0FHeEJoRCxLQUFLaUQsY0FBZ0JGLEVBQ3JCL0MsS0FBS2tELFlBQWM5QixFQUFZUyxjQUUvQnNCLE9BQU9DLGlCQUFpQixTQUFVcEQsS0FBS3FELGNBQWNwRSxLQUFLZSxPQXFEbEUsT0FsRFk4QyxFQUFBekQsVUFBQWdFLGNBQVIsV0FDSXpELEVBQWNlLFFBQVFsQixFQUFPRSxpQkFBa0JLLEtBQUtrRCxZQUFZTixlQUc3REUsRUFBQXpELFVBQUFpRSxpQkFBUCxXQUNJLElBQU1DLEVBQU92RCxLQUNiLE9BQU8sV0FDSCxJQUFNZ0QsRUFBWWhELEtBQUt0QixNQUNqQjhFLEVBQXFCRCxFQUFLTCxZQUFZbkIsT0FBT2lCLEdBQ25ETyxFQUFLTixjQUFjTyxHQUNuQkQsRUFBS1AsVUFBWUEsSUFJbEJGLEVBQUF6RCxVQUFBb0UsYUFBUCxTQUFvQnZCLEdBQXBCLElBQUFaLEVBQUF0QixLQUNJLE9BQU8sV0FDSCxJQUFNMEMsRUFBZXBCLEVBQUs0QixZQUFZNUUsSUFBSTRELEVBQUdqQyxJQUM3Q3lDLEVBQWFuQyxlQUNiZSxFQUFLNEIsWUFBWVYsUUFBUUUsR0FDekJwQixFQUFLMkIsa0JBSU5ILEVBQUF6RCxVQUFBcUUsWUFBUCxTQUFtQnhCLEdBQW5CLElBQUFaLEVBQUF0QixLQUNJLE9BQU8sU0FBQzJELEdBQ0osSUFBTTVELEVBQVE0RCxFQUFFQyxPQUFlQyxZQUN6Qm5CLEVBQWVwQixFQUFLNEIsWUFBWTVFLElBQUk0RCxFQUFHakMsSUFDN0N5QyxFQUFhbEMsV0FBV1QsR0FDeEJ1QixFQUFLNEIsWUFBWVYsUUFBUUUsS0FJMUJJLEVBQUF6RCxVQUFBeUUsY0FBUCxlQUFBeEMsRUFBQXRCLEtBQ0ksT0FBTyxXQUNIc0IsRUFBSzRCLFlBQVlaLE1BQ2pCaEIsRUFBSzJCLGtCQUlOSCxFQUFBekQsVUFBQTBFLGNBQVAsU0FBcUI3QixHQUFyQixJQUFBWixFQUFBdEIsS0FDSSxPQUFPLFdBQ0hzQixFQUFLNEIsWUFBWVAsT0FBT1QsRUFBR2pDLElBQzNCLElBQUkrRCxFQUFjMUMsRUFBSzRCLFlBQVlOLGFBQzdCdEIsRUFBSzBCLFlBQ1BnQixFQUFjMUMsRUFBSzRCLFlBQVluQixPQUFPVCxFQUFLMEIsWUFFL0MxQixFQUFLMkIsY0FBY2UsS0FJL0JsQixFQTlEQSxJQ0hpQixJQ0dqQixXQUtJLFNBQUFtQixJQUNJakUsS0FBS2tFLFdBQWEsSUFBSXJCLEVBQVc3QyxLQUFLbUUsa0JBQWtCbEYsS0FBS2UsT0FDN0RBLEtBQUtvRSxhQUFlaEQsRUFBWVMsY0FBY2UsYUFDOUM1QyxLQUFLcUUsT0FBU0MsU0FBU0MsZUFBZTlFLEVBQU9DLFVBd0ZyRCxPQXJGV3VFLEVBQUE1RSxVQUFBbUYsT0FBUCxXQUNJLElBQU1DLEVBQVdILFNBQVNJLHlCQUMxQkQsRUFBU0UsT0FDTDNFLEtBQUs0RSxrQkFDTDVFLEtBQUs2RSxxQkFDTDdFLEtBQUs4RSx3QkFHVDlFLEtBQUtxRSxPQUFPVSxRQUFRVCxTQUFTVSxjQUFjLFFBQzNDaEYsS0FBS3FFLE9BQU9ZLFNBQVMsR0FBR0MsWUFBWVQsSUFHaENSLEVBQUE1RSxVQUFBOEUsa0JBQVIsU0FBMEJnQixRQUFBLElBQUFBLE1BQWtDbkYsS0FBS29FLGNBQzdEcEUsS0FBS29FLGFBQWVlLEVBRVRiLFNBQVNjLGNBQWMsa0NBQy9CQyxZQUFZckYsS0FBSzZFLHVCQUdoQlosRUFBQTVFLFVBQUF1RixnQkFBUixXQUNJLElBQU1VLEVBQVFoQixTQUFTVSxjQUFjLFNBTXJDLE9BTEFNLEVBQU1DLFVBQVksNkJBQ2xCRCxFQUFNRSxZQUFjLHVCQUNwQkYsRUFBTUcsV0FBWSxFQUNsQkgsRUFBTUksUUFBVTFGLEtBQUtrRSxXQUFXWixtQkFFekJnQyxHQUdIckIsRUFBQTVFLFVBQUF3RixtQkFBUixlQUFBdkQsRUFBQXRCLEtBQ1UyRixFQUFjckIsU0FBU1UsY0FBYyxPQU8zQyxPQU5BVyxFQUFZSixVQUFZLGdDQUV4QnZGLEtBQUtvRSxhQUFhMUMsUUFBUSxTQUFBUSxHQUN0QnlELEVBQVlULFlBQVk1RCxFQUFLc0Usa0JBQWtCMUQsTUFHNUN5RCxHQUdIMUIsRUFBQTVFLFVBQUF1RyxrQkFBUixTQUEwQjFELEdBQ3RCLElBQU0yRCxFQUFxQnZCLFNBQVNVLGNBQWMsT0FDbERhLEVBQW1CTixVQUFZLHdCQUUvQixJQUFNTyxFQUFzQnhCLFNBQVNVLGNBQWMsU0FDbkRjLEVBQW9CQyxLQUFPLFdBQzNCRCxFQUFvQlAsVUFBWSxpQ0FDaENPLEVBQW9CRSxRQUFVOUQsRUFBRzVCLE9BQ2pDd0YsRUFBb0JHLFFBQVVqRyxLQUFLa0UsV0FBV1QsYUFBYXZCLEdBRTNELElBQU1nRSxFQUFtQjVCLFNBQVNVLGNBQWMsUUFDMUNtQixFQUEwQmpFLEVBQUc1QixPQUFTLG9DQUFzQyxHQUNsRjRGLEVBQWlCWCxVQUFZLDhCQUFnQ1ksRUFDN0RELEVBQWlCRSxVQUFZbEUsRUFBR25DLEtBQ2hDbUcsRUFBaUJHLGdCQUFrQixPQUNuQ0gsRUFBaUJSLFFBQVUxRixLQUFLa0UsV0FBV1IsWUFBWXhCLEdBRXZELElBQU1vRSxFQUFvQmhDLFNBQVNVLGNBQWMsUUFZakQsT0FYQXNCLEVBQWtCZixVQUFZLCtCQUM5QmUsRUFBa0JGLFVBQVksSUFDOUJFLEVBQWtCQyxNQUFRLGlCQUMxQkQsRUFBa0JMLFFBQVVqRyxLQUFLa0UsV0FBV0gsY0FBYzdCLEdBRTFEMkQsRUFBbUJsQixPQUNmbUIsRUFDQUksRUFDQUksR0FHR1QsR0FHSDVCLEVBQUE1RSxVQUFBeUYscUJBQVIsV0FDSSxJQUFNMEIsRUFBaUJsQyxTQUFTVSxjQUFjLE9BQzlDd0IsRUFBZWpCLFVBQVksNEJBRTNCLElBQU1rQixFQUF1Qm5DLFNBQVNVLGNBQWMsUUFPcEQsT0FOQXlCLEVBQXFCbEIsVUFBWSxtQ0FDakNrQixFQUFxQkwsVUFBWSx3QkFDakNLLEVBQXFCUixRQUFVakcsS0FBS2tFLFdBQVdKLGdCQUUvQzBDLEVBQWV0QixZQUFZdUIsR0FFcEJELEdBRWZ2QyxFQWhHQSxLREZTTyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgY29uc3QgY29uZmlnID0ge1xuICAgIGhvbGRlcklkOiAncm9vdC1ob2xkZXInLFxuICAgIGxvY2FsZVN0b3JhZ2VLZXk6ICd0b1RvU3RvcmFnZSdcbn07XG4iLCJpbXBvcnQgeyBjcmVhdGVVaWQgfSBmcm9tIFwiLi9oZWxwZXJzL2N0cmF0ZVVpZFwiO1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdE1vZGVsIHtcbiAgICBwdWJsaWMgaWQ6IHN0cmluZztcbiAgICBwdWJsaWMgdGV4dDogc3RyaW5nO1xuICAgIHB1YmxpYyBpc0RvbmU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcih0ZXh0Pzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuaWQgPSBjcmVhdGVVaWQoKTtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dCB8fCAn0J3QvtCy0YvQuSDQv9GA0L7QtdC60YInO1xuICAgICAgICB0aGlzLmlzRG9uZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyB0b2dnbGVTdGF0dXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaXNEb25lID0gIXRoaXMuaXNEb25lO1xuICAgIH1cblxuICAgIHB1YmxpYyBjaGFuZ2VUZXh0KHRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGUoZGF0YTogUHJvamVjdFBsYWluRGF0YSk6IFByb2plY3RNb2RlbCB7XG4gICAgICAgIHRoaXMuaWQgPSBkYXRhLmlkO1xuICAgICAgICB0aGlzLnRleHQgPSBkYXRhLnRleHQ7XG4gICAgICAgIHRoaXMuaXNEb25lID0gZGF0YS5pc0RvbmU7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByb2plY3RQbGFpbkRhdGEge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIGlzRG9uZTogYm9vbGVhbjtcbn1cbiIsImV4cG9ydCBuYW1lc3BhY2UgTG9jYWxlU3RvcmFnZSB7XG4gICAgZXhwb3J0IGZ1bmN0aW9uIHNldEl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiB2b2lkIHtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG5cdH1cblxuXHRleHBvcnQgZnVuY3Rpb24gZ2V0SXRlbTxUID0gYW55PihrZXk6IHN0cmluZyk6IFQge1xuXHRcdHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpIGFzIFQ7XG5cdH1cblxuXHRleHBvcnQgZnVuY3Rpb24gcmVtb3ZlSXRlbShrZXk6IHN0cmluZyk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRhaW5zKGtleSkpIHtcblx0XHRcdGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG5cdFx0fVxuXHR9XG5cblx0ZXhwb3J0IGZ1bmN0aW9uIGNvbnRhaW5zKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuICEhbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcblx0fVxuXG5cdGV4cG9ydCBmdW5jdGlvbiBjbGVhcigpOiB2b2lkIHtcblx0XHRsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcblx0fVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVpZCgpOiBzdHJpbmcge1xuXHRyZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KSArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSk7XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0TW9kZWwsIFByb2plY3RQbGFpbkRhdGEgfSBmcm9tICcuL1Byb2plY3RNb2RlbCc7XG5pbXBvcnQgeyBMb2NhbGVTdG9yYWdlIH0gZnJvbSAnLi9oZWxwZXJzL0xvY2FsU3RvcmFnZSc7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZy9jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgRGF0YVN0b3JhZ2Uge1xuICAgIHByaXZhdGUgc3RvcmFnZTogQXJyYXk8UHJvamVjdE1vZGVsPiA9IFtdO1xuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBEYXRhU3RvcmFnZTtcblxuXHRzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XG5cdFx0aWYgKCFEYXRhU3RvcmFnZS5pbnN0YW5jZSkge1xuXHRcdFx0RGF0YVN0b3JhZ2UuaW5zdGFuY2UgPSBuZXcgRGF0YVN0b3JhZ2UoKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gRGF0YVN0b3JhZ2UuaW5zdGFuY2U7XG4gICAgfVxuICAgIFxuXHRwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBMb2NhbGVTdG9yYWdlLmdldEl0ZW08QXJyYXk8UHJvamVjdFBsYWluRGF0YT4+KGNvbmZpZy5sb2NhbGVTdG9yYWdlS2V5KTtcbiAgICAgICAgaWYgKCEhc2F2ZWREYXRhICYmICEhc2F2ZWREYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgc2F2ZWREYXRhLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnB1c2gobmV3IFByb2plY3RNb2RlbCgpLnVwZGF0ZShpdGVtKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXHR9XG5cbiAgICBwdWJsaWMgc2VhcmNoKHN0cjogc3RyaW5nKTogQXJyYXk8UHJvamVjdE1vZGVsPiB7XG4gICAgICAgIGlmICghc3RyLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmZpbHRlcihwbSA9PiBwbS50ZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzdHIudG9Mb3dlckNhc2UoKSkgPj0gMCk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldChpZDogc3RyaW5nKTogUHJvamVjdE1vZGVsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5maW5kKHBtID0+IHBtLmlkID09PSBpZCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZCh0ZXh0Pzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcG0gPSBuZXcgUHJvamVjdE1vZGVsKHRleHQpO1xuICAgICAgICB0aGlzLnN0b3JhZ2UudW5zaGlmdChwbSk7XG4gICAgICAgIHJldHVybiBwbS5pZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVwbGFjZShwbTogUHJvamVjdE1vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5tYXAocHJvamVjdE1vZGVsID0+IHtcbiAgICAgICAgICAgIGlmIChwcm9qZWN0TW9kZWwuaWQgPT09IHBtLmlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb2plY3RNb2RlbDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZShpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHRoaXMuc3RvcmFnZS5maWx0ZXIocG0gPT4gcG0uaWQgIT09IGlkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0U3RvcmFnZSgpOiBBcnJheTxQcm9qZWN0TW9kZWw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBEYXRhU3RvcmFnZSB9IGZyb20gXCIuL0RhdGFTdG9yYWdlXCI7XG5pbXBvcnQgeyBQcm9qZWN0TW9kZWwgfSBmcm9tIFwiLi9Qcm9qZWN0TW9kZWxcIjtcbmltcG9ydCB7IExvY2FsZVN0b3JhZ2UgfSBmcm9tIFwiLi9oZWxwZXJzL0xvY2FsU3RvcmFnZVwiO1xuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSBcIi4vY29uZmlnL2NvbmZpZ1wiO1xuXG5leHBvcnQgY2xhc3MgQ29udHJvbGxlciB7XG4gICAgcHJpdmF0ZSBkYXRhU3RvcmFnZTogRGF0YVN0b3JhZ2U7XG4gICAgcHJpdmF0ZSByZW5kZXJVcGRhdGVyOiBGdW5jdGlvbjtcbiAgICBwcml2YXRlIHNlYXJjaFN0cjogc3RyaW5nID0gJyc7XG5cbiAgICBjb25zdHJ1Y3Rvcih1cGRhdGVyOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLnJlbmRlclVwZGF0ZXIgPSB1cGRhdGVyO1xuICAgICAgICB0aGlzLmRhdGFTdG9yYWdlID0gRGF0YVN0b3JhZ2UuZ2V0SW5zdGFuY2UoKTtcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgdGhpcy51bmxvYWRIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgdW5sb2FkSGFuZGxlcigpOiB2b2lkIHtcbiAgICAgICAgTG9jYWxlU3RvcmFnZS5zZXRJdGVtKGNvbmZpZy5sb2NhbGVTdG9yYWdlS2V5LCB0aGlzLmRhdGFTdG9yYWdlLmdldFN0b3JhZ2UoKSlcbiAgICB9XG5cbiAgICBwdWJsaWMgc2VhcmNoQnlQcm9qZWN0cygpOiAoKSA9PiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlYXJjaFN0ciA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRGF0YVN0b3JhZ2UgPSB0aGF0LmRhdGFTdG9yYWdlLnNlYXJjaChzZWFyY2hTdHIpO1xuICAgICAgICAgICAgdGhhdC5yZW5kZXJVcGRhdGVyKHVwZGF0ZWREYXRhU3RvcmFnZSk7XG4gICAgICAgICAgICB0aGF0LnNlYXJjaFN0ciA9IHNlYXJjaFN0cjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBjbGlja1Byb2plY3QocG06IFByb2plY3RNb2RlbCk6ICgpID0+IHZvaWQge1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdE1vZGVsID0gdGhpcy5kYXRhU3RvcmFnZS5nZXQocG0uaWQpO1xuICAgICAgICAgICAgcHJvamVjdE1vZGVsLnRvZ2dsZVN0YXR1cygpO1xuICAgICAgICAgICAgdGhpcy5kYXRhU3RvcmFnZS5yZXBsYWNlKHByb2plY3RNb2RlbCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclVwZGF0ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBlZGl0UHJvamVjdChwbTogUHJvamVjdE1vZGVsKTogKGU6IEV2ZW50KSA9PiB2b2lkIHtcbiAgICAgICAgcmV0dXJuIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGV4dCA9IChlLnRhcmdldCBhcyBhbnkpLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdE1vZGVsID0gdGhpcy5kYXRhU3RvcmFnZS5nZXQocG0uaWQpO1xuICAgICAgICAgICAgcHJvamVjdE1vZGVsLmNoYW5nZVRleHQodGV4dCk7XG4gICAgICAgICAgICB0aGlzLmRhdGFTdG9yYWdlLnJlcGxhY2UocHJvamVjdE1vZGVsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVQcm9qZWN0KCk6ICgpID0+IHZvaWQge1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYXRhU3RvcmFnZS5hZGQoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVXBkYXRlcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZVByb2plY3QocG06IFByb2plY3RNb2RlbCk6ICgpID0+IHZvaWQge1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYXRhU3RvcmFnZS5yZW1vdmUocG0uaWQpO1xuICAgICAgICAgICAgbGV0IHByb2plY3RMaXN0ID0gdGhpcy5kYXRhU3RvcmFnZS5nZXRTdG9yYWdlKCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnNlYXJjaFN0cikge1xuICAgICAgICAgICAgICAgIHByb2plY3RMaXN0ID0gdGhpcy5kYXRhU3RvcmFnZS5zZWFyY2godGhpcy5zZWFyY2hTdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZW5kZXJVcGRhdGVyKHByb2plY3RMaXN0KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tIFwiLi9SZW5kZXJlclwiO1xuXG5jb25zdCByZW5kZXJlciA9IG5ldyBSZW5kZXJlcigpO1xucmVuZGVyZXIucmVuZGVyKCk7XG4iLCJpbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi9jb25maWcvY29uZmlnXCI7XG5pbXBvcnQgeyBQcm9qZWN0TW9kZWwgfSBmcm9tIFwiLi9Qcm9qZWN0TW9kZWxcIjtcbmltcG9ydCB7IERhdGFTdG9yYWdlIH0gZnJvbSBcIi4vRGF0YVN0b3JhZ2VcIjtcbmltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tIFwiLi9Db250cm9sbGVyXCI7XG5cbmV4cG9ydCBjbGFzcyBSZW5kZXJlciB7XG4gICAgcHJpdmF0ZSBjb250cm9sbGVyOiBDb250cm9sbGVyO1xuICAgIHByaXZhdGUgcHJvamVjdHNMaXN0OiBBcnJheTxQcm9qZWN0TW9kZWw+O1xuICAgIHByaXZhdGUgcm9vdEVsOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgQ29udHJvbGxlcih0aGlzLnVwZGF0ZVByb2plY3RMaXN0LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnByb2plY3RzTGlzdCA9IERhdGFTdG9yYWdlLmdldEluc3RhbmNlKCkuZ2V0U3RvcmFnZSgpO1xuICAgICAgICB0aGlzLnJvb3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbmZpZy5ob2xkZXJJZCk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGZyYWdtZW50LmFwcGVuZChcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlSW5wdXROb2RlKCksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVByb2plY3RzTm9kZSgpLFxuICAgICAgICAgICAgdGhpcy5jcmVhdGVOZXdQcm9qZWN0Tm9kZSgpXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5yb290RWwucHJlcGVuZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSk7XG4gICAgICAgIHRoaXMucm9vdEVsLmNoaWxkcmVuWzBdLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVByb2plY3RMaXN0KGRhdGFTb3VyY2U6IEFycmF5PFByb2plY3RNb2RlbD4gPSB0aGlzLnByb2plY3RzTGlzdCkge1xuICAgICAgICB0aGlzLnByb2plY3RzTGlzdCA9IGRhdGFTb3VyY2U7XG5cbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1saXN0X19wcm9qZWN0LXdyYXBwZXInKTtcbiAgICAgICAgZWwucmVwbGFjZVdpdGgodGhpcy5jcmVhdGVQcm9qZWN0c05vZGUoKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVJbnB1dE5vZGUoKTogTm9kZSB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXQuY2xhc3NOYW1lID0gJ3Byb2plY3QtbGlzdF9fc2VhcmNoLWZpbGVkJztcbiAgICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSAn0J/QvtC40YHQuiDQv9C+INC/0YDQvtC10LrRgtCw0LwuLi4nO1xuICAgICAgICBpbnB1dC5hdXRvZm9jdXMgPSB0cnVlO1xuICAgICAgICBpbnB1dC5vbmlucHV0ID0gdGhpcy5jb250cm9sbGVyLnNlYXJjaEJ5UHJvamVjdHMoKTtcblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVQcm9qZWN0c05vZGUoKTogTm9kZSB7XG4gICAgICAgIGNvbnN0IHdyYXBwZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9ICdwcm9qZWN0LWxpc3RfX3Byb2plY3Qtd3JhcHBlcic7XG5cbiAgICAgICAgdGhpcy5wcm9qZWN0c0xpc3QuZm9yRWFjaChwbSA9PiB7XG4gICAgICAgICAgICB3cmFwcGVyTm9kZS5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVByb2plY3ROb2RlKHBtKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB3cmFwcGVyTm9kZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByb2plY3ROb2RlKHBtOiBQcm9qZWN0TW9kZWwpOiBOb2RlIHtcbiAgICAgICAgY29uc3QgcHJvamVjdFdyYXBwZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHByb2plY3RXcmFwcGVyTm9kZS5jbGFzc05hbWUgPSAncHJvamVjdC1saXN0X19wcm9qZWN0JztcblxuICAgICAgICBjb25zdCBwcm9qZWN0Q2hlY2tib3hOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgcHJvamVjdENoZWNrYm94Tm9kZS50eXBlID0gJ2NoZWNrYm94JztcbiAgICAgICAgcHJvamVjdENoZWNrYm94Tm9kZS5jbGFzc05hbWUgPSAncHJvamVjdC1saXN0X19wcm9qZWN0LWNoZWNrYm94JztcbiAgICAgICAgcHJvamVjdENoZWNrYm94Tm9kZS5jaGVja2VkID0gcG0uaXNEb25lO1xuICAgICAgICBwcm9qZWN0Q2hlY2tib3hOb2RlLm9uY2xpY2sgPSB0aGlzLmNvbnRyb2xsZXIuY2xpY2tQcm9qZWN0KHBtKTtcblxuICAgICAgICBjb25zdCBwcm9qZWN0VmFsdWVOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBjb25zdCBwcm9qZWN0VmFsdWVDc3NNb2RpZmllciA9IHBtLmlzRG9uZSA/ICcgcHJvamVjdC1saXN0X19wcm9qZWN0LXZhbHVlX2RvbmUnIDogJydcbiAgICAgICAgcHJvamVjdFZhbHVlTm9kZS5jbGFzc05hbWUgPSAncHJvamVjdC1saXN0X19wcm9qZWN0LXZhbHVlJyArIHByb2plY3RWYWx1ZUNzc01vZGlmaWVyO1xuICAgICAgICBwcm9qZWN0VmFsdWVOb2RlLmlubmVyVGV4dCA9IHBtLnRleHQ7XG4gICAgICAgIHByb2plY3RWYWx1ZU5vZGUuY29udGVudEVkaXRhYmxlID0gJ3RydWUnO1xuICAgICAgICBwcm9qZWN0VmFsdWVOb2RlLm9uaW5wdXQgPSB0aGlzLmNvbnRyb2xsZXIuZWRpdFByb2plY3QocG0pO1xuXG4gICAgICAgIGNvbnN0IHByb2plY3RSZW1vdmVOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBwcm9qZWN0UmVtb3ZlTm9kZS5jbGFzc05hbWUgPSAncHJvamVjdC1saXN0X19yZW1vdmUtcHJvamVjdCc7XG4gICAgICAgIHByb2plY3RSZW1vdmVOb2RlLmlubmVyVGV4dCA9ICdYJztcbiAgICAgICAgcHJvamVjdFJlbW92ZU5vZGUudGl0bGUgPSAn0KPQtNCw0LvQuNGC0Ywg0L/RgNC+0LXQutGCJztcbiAgICAgICAgcHJvamVjdFJlbW92ZU5vZGUub25jbGljayA9IHRoaXMuY29udHJvbGxlci5yZW1vdmVQcm9qZWN0KHBtKTtcblxuICAgICAgICBwcm9qZWN0V3JhcHBlck5vZGUuYXBwZW5kKFxuICAgICAgICAgICAgcHJvamVjdENoZWNrYm94Tm9kZSxcbiAgICAgICAgICAgIHByb2plY3RWYWx1ZU5vZGUsXG4gICAgICAgICAgICBwcm9qZWN0UmVtb3ZlTm9kZVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBwcm9qZWN0V3JhcHBlck5vZGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVOZXdQcm9qZWN0Tm9kZSgpOiBOb2RlIHtcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdE5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbmV3UHJvamVjdE5vZGUuY2xhc3NOYW1lID0gJ3Byb2plY3QtbGlzdF9fYWRkLXByb2plY3QnO1xuXG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3RCdXR0b25Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBuZXdQcm9qZWN0QnV0dG9uTm9kZS5jbGFzc05hbWUgPSAncHJvamVjdC1saXN0X19hZGQtcHJvamVjdC1idXR0b24nO1xuICAgICAgICBuZXdQcm9qZWN0QnV0dG9uTm9kZS5pbm5lclRleHQgPSAn0JTQvtCx0LDQstC40YLRjCDQvdC+0LLRi9C5INC/0YDQvtC10LrRgic7XG4gICAgICAgIG5ld1Byb2plY3RCdXR0b25Ob2RlLm9uY2xpY2sgPSB0aGlzLmNvbnRyb2xsZXIuY3JlYXRlUHJvamVjdCgpO1xuXG4gICAgICAgIG5ld1Byb2plY3ROb2RlLmFwcGVuZENoaWxkKG5ld1Byb2plY3RCdXR0b25Ob2RlKTtcblxuICAgICAgICByZXR1cm4gbmV3UHJvamVjdE5vZGU7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==